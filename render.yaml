# P2PCLAW — Render Blueprint
# Conectar repo a Render Dashboard → New → Blueprint → seleccionar este repo
# Crea API backup + citizens2/3/4/5 (100 agentes total)
# Nota: workers requieren plan starter o superior (no free)

services:
  # API Gateway backup (si Railway cae)
  - type: web
    name: p2pclaw-api-backup
    runtime: node
    plan: free
    region: oregon
    buildCommand: npm install
    startCommand: node packages/api/src/index.js
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: RELAY_NODE
        value: https://p2pclaw-relay-production.up.railway.app/gun
      - key: GROQ_API_KEY
        sync: false
      - key: PINATA_JWT
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: GITHUB_CLIENT_ID
        sync: false
      - key: GITHUB_CLIENT_SECRET
        sync: false
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      # TIER1_VERIFIER_URL: set once HF Space is deployed
      # TIER1_VERIFIER_URL=https://agnuxo-p2pclaw-lean4-verifier.hf.space
    buildFilter:
      paths:
        - packages/api/**/*
        - package.json
        - pnpm-lock.yaml
        - package-lock.json

  # ABRAXAS — Autonomous arXiv agent (Python worker)
  - type: worker
    name: p2pclaw-abraxas
    runtime: python
    plan: starter
    region: oregon
    buildCommand: pip install requests
    startCommand: python scripts/abraxas_agent_loop.py
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: GROQ_API_KEY
        sync: false

  # Citizens2 (20 agentes — LLM-enabled via Groq/OpenRouter)
  - type: worker
    name: p2pclaw-citizens2
    runtime: node
    plan: starter
    region: oregon
    buildCommand: npm install
    startCommand: node packages/agents/citizens2.js
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: RELAY_NODE
        value: https://p2pclaw-relay-production.up.railway.app/gun
      - key: SKIP_PAPERS
        value: "false"
      - key: GROQ_KEYS
        sync: false
      - key: OPENROUTER_KEYS
        sync: false
    buildFilter:
      paths:
        - packages/agents/**/*
        - package.json

  # Citizens3 (21 agentes)
  - type: worker
    name: p2pclaw-citizens3
    runtime: node
    plan: starter
    region: oregon
    buildCommand: npm install
    startCommand: node packages/agents/citizens3.js
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: RELAY_NODE
        value: https://p2pclaw-relay-production.up.railway.app/gun
      - key: SKIP_PAPERS
        value: "false"
      - key: GROQ_KEYS
        sync: false
      - key: OPENROUTER_KEYS
        sync: false

  # Citizens4 (21 agentes)
  - type: worker
    name: p2pclaw-citizens4
    runtime: node
    plan: starter
    region: oregon
    buildCommand: npm install
    startCommand: node packages/agents/citizens4.js
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: RELAY_NODE
        value: https://p2pclaw-relay-production.up.railway.app/gun
      - key: SKIP_PAPERS
        value: "false"
      - key: GROQ_KEYS
        sync: false
      - key: OPENROUTER_KEYS
        sync: false

  # Citizens5 (20 agentes)
  - type: worker
    name: p2pclaw-citizens5
    runtime: node
    plan: starter
    region: oregon
    buildCommand: npm install
    startCommand: node packages/agents/citizens5.js
    envVars:
      - key: GATEWAY
        value: https://p2pclaw-mcp-server-production.up.railway.app
      - key: RELAY_NODE
        value: https://p2pclaw-relay-production.up.railway.app/gun
      - key: SKIP_PAPERS
        value: "false"
      - key: GROQ_KEYS
        sync: false
      - key: OPENROUTER_KEYS
        sync: false
